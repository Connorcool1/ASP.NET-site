@* @model WebApp.Models.ProductModel

@{
    ViewData["Title"] = "Edit Product";
}

<h2>Edit Product</h2>

<form asp-action="Update" method="post" enctype="multipart/form-data">
    <input type="hidden" asp-for="ID" />
    <div class="form-group">
        <label asp-for="Name"></label>
        <input asp-for="Name" class="form-control" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Price"></label>
        <input asp-for="Price" class="form-control" />
        <span asp-validation-for="Price" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Description"></label>
        <textarea asp-for="Description" class="form-control"></textarea>
        <span asp-validation-for="Description" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Stock"></label>
        <input asp-for="Stock" class="form-control" />
        <span asp-validation-for="Stock" class="text-danger"></span>
    </div>

    <!-- Display existing image if it exists -->
    @if (Model.Image != null && Model.Image.Length > 0)
    {
        <div class="form-group">
            <label>Current Product Image</label>
            <img src="data:image/png;base64,@Convert.ToBase64String(Model.Image)" class="img-thumbnail" alt="Product Image" style="max-width: 200px;" />
        </div>
    }

    <!-- Input for uploading a new image -->
    <div class="form-group">
        <label asp-for="ImageFile">Upload New Product Image</label>
        <input asp-for="ImageFile" class="form-control" />
        <span asp-validation-for="ImageFile"></span>
    </div>

    <div class="form-group">
        <input type="submit" value="Save Changes" class="btn btn-primary" />
        <a asp-action="Index" class="btn btn-secondary">Cancel</a>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
} *@

@model WebApp.Models.ProductModel

@{
    ViewData["Title"] = "Edit Product";
}

<h2 class="text-center">Edit Product</h2>

<form asp-action="Update" method="post" enctype="multipart/form-data" class="product-form">
    <input type="hidden" asp-for="ID" />
    
    <!-- Display current image at the top, centered, without label -->
    @if (Model.Image != null && Model.Image.Length > 0)
    {
        <div class="form-group text-center">
            <div class="image-container">
                <img id="productImage" src="data:image/png;base64,@Convert.ToBase64String(Model.Image)" class="img-thumbnail" alt="Product Image" style="max-width: 200px;" />
                <input type="file" id="imageUpload" asp-for="ImageFile" class="form-control" style="display:none;" onchange="previewImage(event)" />
            </div>
            <span asp-validation-for="ImageFile" class="text-danger"></span>
        </div>
    }

    <div class="form-group">
        <label asp-for="Name" class="form-label"></label>
        <input asp-for="Name" class="form-control form-input" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Price" class="form-label"></label>
        <input asp-for="Price" class="form-control form-input price-input" />
        <span asp-validation-for="Price" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Description" class="form-label"></label>
        <textarea asp-for="Description" class="form-control form-input description-box"></textarea>
        <span asp-validation-for="Description" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Stock" class="form-label">Current Stock</label>
        <input asp-for="Stock" class="form-control form-input stock-input" />
        <span asp-validation-for="Stock" class="text-danger"></span>
    </div>

    <div class="form-group text-center">
        <input type="submit" value="Save Changes" class="btn btn-primary btn-submit" />
        <a asp-action="Index" class="btn btn-secondary btn-cancel">Cancel</a>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.getElementById('productImage').addEventListener('click', function() {
            document.getElementById('imageUpload').click();
        });

        function previewImage(event) {
            const reader = new FileReader();
            reader.onload = function(){
                const output = document.getElementById('productImage');
                output.src = reader.result;
            };
            reader.readAsDataURL(event.target.files[0]);
        }
    </script>
}

<!-- Custom Styles -->
<style>
    body {
        background-color: #2c2f33;
        color: #ffffff;
        font-family: Arial, sans-serif;
    }

    h2 {
        color: #7289da;
        margin-bottom: 20px;
    }

    .product-form {
        background-color: #23272a;
        padding: 20px;
        border-radius: 8px;
        max-width: 600px;
        margin: 0 auto;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .form-group {
        margin-bottom: 15px;
    }

    .form-label {
        color: #7289da;
        font-weight: bold;
    }

    .form-input {
        background-color: #2c2f33;
        border: 1px solid #7289da;
        color: #ffffff;
    }

    .form-input:focus {
        border-color: #99aab5;
        outline: none;
        box-shadow: 0 0 8px rgba(114, 137, 218, 0.5);
    }

    .description-box {
        height: 150px;
        resize: vertical;
    }

    .stock-input, .price-input {
        width: 100px;
    }

    .image-container {
        position: relative;
        display: inline-block;
        cursor: pointer;
    }

    .image-container:hover::after {
        content: 'Click to upload new image';
        color: #ffffff;
        background-color: rgba(0, 0, 0, 0.6);
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 5px;
        text-align: center;
        font-size: 12px;
    }

    .btn-submit {
        background-color: #7289da;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        color: #ffffff;
        cursor: pointer;
        border-radius: 4px;
        transition: background-color 0.3s;
    }

    .btn-submit:hover {
        background-color: #99aab5;
    }

    .btn-cancel {
        background-color: #99aab5;
        color: #ffffff;
        padding: 10px 20px;
        border-radius: 4px;
        margin-left: 10px;
        transition: background-color 0.3s;
    }

    .btn-cancel:hover {
        background-color: #7289da;
    }

    .text-danger {
        color: #ff6b6b;
    }
</style>
